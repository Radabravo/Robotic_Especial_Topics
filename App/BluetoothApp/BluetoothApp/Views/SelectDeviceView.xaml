<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BluetoothApp.Views.SelectDeviceView"
             xmlns:converters="clr-namespace:BluetoothApp.Services.Converters" >

    <ContentPage.Content>
        <StackLayout>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="15"/>
                    <RowDefinition Height="300"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="60"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="5"/>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackLayout
                    Grid.Column="1"
                    Grid.Row="1"
                    IsVisible="{Binding IsConnected, Converter={converters:InverseConverter}}">
                    <Label Text="Selecione o dispositivo"
                   
                   
                   FontSize="32"
                   FontAttributes="Bold"
                   HorizontalTextAlignment="Center"
                    />
                    <ListView 
                     
                    ItemsSource="{Binding DeviceList}"
                    SelectedItem="{Binding SelectedDevice}"
                    x:Name="lvBondedDevices"
                    >
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <TextCell Text="{Binding Name}"
                                  TextColor="Black" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackLayout>
                
                <StackLayout
                    Grid.Row="3"
                    Grid.RowSpan="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"                     
                    IsVisible="{Binding IsConnected}">
                    <Picker
                    VerticalOptions="Start"
                    ItemsSource="{Binding CommandList}"
                    SelectedIndex="{Binding SelectedCommand}"
                    HorizontalOptions="Center"
                    FontSize="32">
                    </Picker>
                    <Button
                    Text="Comando"
                    x:Name="btnSend"
                    Clicked="btnSend_Clicked" 
                    HorizontalOptions="Center"
                    Margin="5"/>
                </StackLayout>
                <StackLayout
                IsVisible="{Binding IsConnected}"
                    Grid.Row="1"
                    Grid.RowSpan="1"
                    Grid.Column="2">
                    <Label Text="Velocidade Média"
                   FontSize="32"                   
                   HorizontalTextAlignment="Center" />
                    <Label                                                     
                   FontSize="32"
                   HorizontalTextAlignment="Center"                    
                   VerticalOptions="Fill">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="{Binding AvgVel, Mode=TwoWay, StringFormat='{0:F3}'}"/>
                                <Span Text=" m/s"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                    <Label Text="Deslocamento Real"
                   FontSize="32"
                   HorizontalTextAlignment="Center" />
                    <Label 
                   FontSize="32"
                   HorizontalTextAlignment="Center" 
                   VerticalOptions="Fill">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="{Binding RealDisplacement, Mode=TwoWay, StringFormat='{0:F3}'}"/>
                                <Span Text=" m"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                    <Label Text="Deslocamento Calculado"
                   FontSize="32"
                   HorizontalTextAlignment="Center" />
                    <Label 
                   FontSize="32"
                   HorizontalTextAlignment="Center" 
                   VerticalOptions="Fill">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="{Binding CalculateDisplacement, Mode=TwoWay,  StringFormat='{0:F3}'}"/>
                                <Span Text=" m"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                    <Label Text="MPU"
                   FontSize="32"
                   HorizontalTextAlignment="Center" />
                    <Label 
                   FontSize="32"
                   HorizontalTextAlignment="Center" 
                   VerticalOptions="Fill">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text=" Dy "/>
                                <Span Text="{Binding DyMPU, Mode=TwoWay,  StringFormat='{0:F2}'}"/>
                                <Span Text=" m / "/>
                                <Span Text=" Dx "/>
                                <Span Text="{Binding DxMPU, Mode=TwoWay,  StringFormat='{0:F2}'}"/>
                                <Span Text=" m"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                </StackLayout>
                <StackLayout
                    Grid.Row="6"
                    Grid.Column="0"
                    Grid.ColumnSpan="3">
                   
                    <Button
                                     
                    Text="Conectar"
                    x:Name="btnConnect"
                    Clicked="btnConnect_Clicked" 
                    HorizontalOptions="Center"
                    Margin="5"/>
                </StackLayout>
                   
            </Grid>
            

        </StackLayout>
    </ContentPage.Content>
</ContentPage>